# CoTune ‚Äî –î–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è P2P –º—É–∑—ã–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å

CoTune ‚Äî —ç—Ç–æ Android-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∞–Ω–∞–ª–æ–≥ Spotify –ø–æ UX, –Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ:

- ‚úÖ **–ù–µ—Ç —Å–µ—Ä–≤–µ—Ä–æ–≤** ‚Äî –∫–∞–∂–¥—ã–π Android-–¥–µ–≤–∞–π—Å —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–º P2P —É–∑–ª–æ–º
- ‚úÖ **–ù–µ—Ç —Ç–æ—Ä—Ä–µ–Ω—Ç-—Ç—Ä–µ–∫–µ—Ä–æ–≤** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Kademlia DHT
- ‚úÖ **–ù–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏** ‚Äî –∞–Ω–æ–Ω–∏–º–Ω–∞—è —Å–µ—Ç—å –±–µ–∑ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
- ‚úÖ **–ù–µ—Ç —ç–∫–æ–Ω–æ–º–∏–∫–∏** ‚Äî –Ω–∏–∫–∞–∫–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤, —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –∏–ª–∏ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏

–ú—É–∑—ã–∫–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –∏ —Å—Ç—Ä–∏–º–∏—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é —Å Android-—É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ä–µ–ø–ª–∏—Ü–∏—Ä—É–µ—Ç—Å—è –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏ (–ø–æ –ª–∞–π–∫–∞–º).

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
CoTune2/
‚îú‚îÄ‚îÄ go-backend/              # Go daemon (libp2p P2P —É–∑–µ–ª)
‚îÇ   ‚îú‚îÄ‚îÄ cmd/daemon/         # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ daemon
‚îÇ   ‚îú‚îÄ‚îÄ internal/           # –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ host/          # libp2p host (TCP, QUIC, Noise, etc.)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dht/           # Kademlia DHT –¥–ª—è provider records
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ctr/           # Canonical Track Resolution
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ search/        # –ü–æ–∏—Å–∫ –ø–æ —Ç–æ–∫–µ–Ω–∞–º
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ streaming/     # Chunk-based streaming
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ storage/       # –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api/proto/     # Protobuf/gRPC IPC —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ api/               # Protobuf —Å—Ö–µ–º–∞
‚îú‚îÄ‚îÄ flutter-app/           # Flutter UI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ lib/               # Dart –∫–æ–¥
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ screens/       # UI —ç–∫—Ä–∞–Ω—ã (search, my_music, profile)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/      # –°–µ—Ä–≤–∏—Å—ã (P2P, storage, audio)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ generated/     # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π protobuf –∫–æ–¥
‚îÇ   ‚îî‚îÄ‚îÄ android/           # Android-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –∫–æ–¥
‚îÇ       ‚îî‚îÄ‚îÄ app/src/main/kotlin/  # Kotlin bridge
‚îî‚îÄ‚îÄ docs/                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Go 1.24+** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 1.25.5)
- **Flutter SDK 3.10+**
- **protoc** (Protocol Buffers compiler)
- **Android SDK** –∏ NDK

### –°–±–æ—Ä–∫–∞ Go daemon

```bash
cd go-backend
go mod download

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è protobuf –∫–æ–¥–∞
./generate_proto.sh  # Linux/macOS
# –∏–ª–∏
generate_proto.bat   # Windows

# –°–±–æ—Ä–∫–∞ –¥–ª—è Android
./build_android.sh   # Linux/macOS
# –∏–ª–∏
build_android.bat    # Windows
```

–ë–∏–Ω–∞—Ä–Ω–∏–∫–∏ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ `flutter-app/android/app/src/main/jniLibs/`.

### –ó–∞–ø—É—Å–∫ Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
cd flutter-app

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Dart protobuf –∫–æ–¥–∞
./generate_proto_dart.sh  # Linux/macOS
# –∏–ª–∏
generate_proto_dart.bat   # Windows

# –ó–∞–ø—É—Å–∫ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
flutter run
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ [`docs/`](docs/):

- **[–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](docs/ARCHITECTURE.md)** ‚Äî –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **[–°–±–æ—Ä–∫–∞ –¥–ª—è Android](docs/ANDROID_BUILD.md)** ‚Äî –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å–±–æ—Ä–∫–µ
- **[Protobuf IPC](docs/PROTOBUF_IPC.md)** ‚Äî IPC –ø—Ä–æ—Ç–æ–∫–æ–ª —á–µ—Ä–µ–∑ Protobuf/gRPC
- **[–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¢–ó](docs/TZ_COMPLIANCE_CHECK.md)** ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
- **[–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã](docs/KNOWN_ISSUES.md)** ‚Äî Troubleshooting
- **[–ò–Ω–¥–µ–∫—Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](docs/INDEX.md)** ‚Äî –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤—Å–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

## üîë –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### Canonical Track Resolution (CTR)

–ö–∞–∂–¥—ã–π —Ç—Ä–µ–∫ –∏–º–µ–µ—Ç **Canonical Track ID (CTID)** = SHA256(–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ PCM):

- ‚úÖ –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –±–∏—Ç—Ä–µ–π—Ç–∞, –∫–æ–¥–µ–∫–∞, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- ‚úÖ –û–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ç—Ä–µ–∫ ‚Üí –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π CTID
- ‚úÖ –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ —Ñ–æ–Ω–µ

### Distributed Index (DHT)

–í DHT —Ö—Ä–∞–Ω—è—Ç—Å—è **–¢–û–õ–¨–ö–û** provider records:

- Key: `/ctid/<CTID>`
- Value: PeerID
- TTL: 24 —á–∞—Å–∞

‚ùå **–ó–∞–ø—Ä–µ—â–µ–Ω–æ**: –∞—É–¥–∏–æ—Ñ–∞–π–ª—ã, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∏–Ω–¥–µ–∫—Å—ã

### –ü–æ–∏—Å–∫ –±–µ–∑ Flood

1. –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞: `FindProviders(/token/<hash>)`
3. –ó–∞–ø—Ä–æ—Å –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ —É –ø–∏—Ä–æ–≤ —á–µ—Ä–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª `/cotune/index/1.0.0`
4. `FindProviders(/ctid/<CTID>)` ‚Üí –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤ –ø–∏—Ä–æ–≤

### –†–µ–ø–ª–∏–∫–∞—Ü–∏—è

–†–µ–ø–ª–∏–∫–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–¢–û–õ–¨–ö–û** –ø–æ –¥–µ–π—Å—Ç–≤–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª "–ª–∞–π–∫"
2. –¢—Ä–µ–∫ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è (–µ—Å–ª–∏ —É–¥–∞–ª–µ–Ω–Ω—ã–π)
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
4. –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–∑–¥–∞–≤–∞—Ç—å: `Provide(/ctid/<CTID>)`

–ù–∏–∫–∞–∫–æ–π –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –Ω–µ—Ç.

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **libp2p v0.45.0** ‚Äî P2P —Å–µ—Ç—å
  - TCP, QUIC —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—ã
  - Noise security
  - AutoNAT, Hole Punching
  - Relay v2 (fallback)
  - Kademlia DHT (WAN)

- **Protobuf/gRPC** ‚Äî IPC –º–µ–∂–¥—É Flutter/Kotlin –∏ Go daemon
- **BadgerDB** ‚Äî –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- **Flutter** ‚Äî UI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

## üìä –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

**–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¢–ó: ‚úÖ 100%**

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –¥–µ—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è P2P –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ CTR —Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π PCM
- ‚úÖ DHT —Å —Ç–æ–ª—å–∫–æ provider records
- ‚úÖ –ü–æ–∏—Å–∫ –±–µ–∑ flooding
- ‚úÖ Chunk-based streaming
- ‚úÖ –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ –ª–∞–π–∫–∞–º
- ‚úÖ Protobuf IPC —Å–µ—Ä–≤–µ—Ä
- ‚úÖ Android –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (daemon –ø—Ä–æ—Ü–µ—Å—Å)

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–°–º. [LICENSE](LICENSE)
