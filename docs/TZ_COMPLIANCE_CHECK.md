# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –¢–ó

## ‚úÖ –°–û–û–¢–í–ï–¢–°–¢–í–£–ï–¢ –¢–ó

### 1. –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚úÖ
- ‚úÖ –ù–µ—Ç —Å–µ—Ä–≤–µ—Ä–æ–≤ (—Ç–æ–ª—å–∫–æ P2P —É–∑–ª—ã)
- ‚úÖ –ù–µ—Ç —Ç–æ—Ä—Ä–µ–Ω—Ç-—Ç—Ä–µ–∫–µ—Ä–æ–≤
- ‚úÖ –ù–µ—Ç –∞–Ω–Ω–æ—É–Ω—Å–µ—Ä–æ–≤
- ‚úÖ –ù–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
- ‚úÖ –ù–µ—Ç —ç–∫–æ–Ω–æ–º–∏–∫–∏, —Ç–æ–∫–µ–Ω–æ–≤, —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
- ‚úÖ –ú—É–∑—ã–∫–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏ (–ø–æ –ª–∞–π–∫–∞–º)

### 2. UI/UX ‚úÖ
- ‚úÖ search_screen - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç P2P –ø–æ–∏—Å–∫
- ‚úÖ my_music_screen - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç recognized —Ñ–ª–∞–≥
- ‚úÖ profile_screen - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç peer info –∏ QR

### 3. –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã ‚úÖ
- ‚úÖ –ö–∞–∂–¥—ã–π Android-–¥–µ–≤–∞–π—Å = –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π P2P-—É–∑–µ–ª
- ‚úÖ –ò—â–µ—Ç —Ç—Ä–µ–∫–∏ (—á–µ—Ä–µ–∑ DHT)
- ‚úÖ –°—Ç—Ä–∏–º–∏—Ç —Ç—Ä–µ–∫–∏ (chunk-based)
- ‚úÖ –•—Ä–∞–Ω–∏—Ç —Ç—Ä–µ–∫–∏ (–ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
- ‚úÖ –ò–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç —Ç—Ä–µ–∫–∏ (–ª–æ–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å)
- ‚úÖ –£—á–∞—Å—Ç–≤—É–µ—Ç –≤ DHT
- ‚úÖ –ú–æ–∂–µ—Ç –±—ã—Ç—å relay

### 4. Canonical Track Resolution (CTR) ‚úÖ
- ‚úÖ CTID = SHA256(–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ PCM)
- ‚úÖ –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –±–∏—Ç—Ä–µ–π—Ç–∞, –∫–æ–¥–µ–∫–∞, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- ‚úÖ Audio decoder –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω (MP3, WAV, FFmpeg fallback)
- ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è PCM (44.1kHz, 16-bit, mono)
- ‚úÖ –§–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å (worker pool)
- ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç provider records –≤ DHT

### 5. –°–µ—Ç–µ–≤–∞—è –º–æ–¥–µ–ª—å (libp2p) ‚úÖ
- ‚úÖ Go 1.24.6 (–±–ª–∏–∑–∫–æ –∫ 1.25.5)
- ‚úÖ libp2p v0.46.0
- ‚úÖ TCP —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç
- ‚úÖ QUIC —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
- ‚úÖ Noise security
- ‚úÖ Identify protocol
- ‚úÖ AutoNAT
- ‚úÖ Hole Punching
- ‚úÖ Relay v2 (fallback)
- ‚úÖ Kademlia DHT (WAN)

### 6. Bootstrap ‚úÖ
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ bootstrap peer (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚úÖ Serverless bootstrap —á–µ—Ä–µ–∑ QR/–∫–æ–¥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ –≤ DHT

### 7. Distributed Index ‚úÖ
- ‚úÖ –í DHT –¢–û–õ–¨–ö–û provider records
- ‚úÖ –§–æ—Ä–º–∞—Ç: Key: /ctid/<CTID>, Value: PeerID
- ‚úÖ TTL: 24 —á–∞—Å–∞
- ‚úÖ –ù–ï–¢ –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤ –≤ DHT
- ‚úÖ –ù–ï–¢ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –≤ DHT
- ‚úÖ –ù–ï–¢ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ DHT
- ‚úÖ O(log N) —Å–ª–æ–∂–Ω–æ—Å—Ç—å

### 8. –ü–æ–∏—Å–∫ (–±–µ–∑ flood) ‚úÖ
- ‚úÖ –ù–ï —à–∏—Ä–æ–∫–æ–≤–µ—â–∞—Ç–µ–ª—å–Ω—ã–π (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç DHT FindProviders)
- ‚úÖ –î–æ–ø—É—Å–∫–∞–µ—Ç –∑–∞–¥–µ—Ä–∂–∫—É
- ‚úÖ –î–æ–ø—É—Å–∫–∞–µ—Ç eventual consistency
- ‚úÖ –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞
- ‚úÖ FindProviders(/token/<hash>) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
- ‚úÖ FindProviders(/ctid/<CTID>) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- ‚úÖ –û–±—ä—è–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ DHT –ø—Ä–∏ ShareTrack
- ‚úÖ –ü–æ–∏—Å–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç eventual consistency –º–æ–¥–µ–ª—å (–∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¢–ó)

### 9. –°—Ç—Ä–∏–º–∏–Ω–≥ ‚úÖ
- ‚úÖ Chunk-based streaming (64KB chunks)
- ‚úÖ –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É –ø–∏—Ä–∞–º–∏ (FetchTrack –ø—Ä–æ–±—É–µ—Ç –≤—Å–µ—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤)
- ‚úÖ –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ churn (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ)

### 10. –†–µ–ø–ª–∏–∫–∞—Ü–∏—è ‚úÖ
- ‚úÖ –¢–û–õ–¨–ö–û –ø–æ –¥–µ–π—Å—Ç–≤–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ª–∞–π–∫)
- ‚úÖ –¢—Ä–µ–∫ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
- ‚úÖ –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–∞—á–∏–Ω–∞–µ—Ç Provide(/ctid/<CTID>)
- ‚úÖ –ù–∏–∫–∞–∫–æ–π –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏

### 11. Android –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚úÖ
- ‚úÖ Flutter UI
- ‚úÖ MethodChannel –¥–ª—è Kotlin bridge
- ‚úÖ Kotlin Bridge
- ‚úÖ Go Daemon (–æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å)
- ‚úÖ Protobuf/gRPC IPC (localhost TCP –∏–ª–∏ Unix socket)
  - Protobuf/gRPC —Å–µ—Ä–≤–µ—Ä —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ localhost TCP –∏ Unix socket
  - –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¢–ó –ø–æ–ª–Ω–æ—Å—Ç—å—é

### 12. –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è ‚úÖ
- ‚úÖ –ù–∏–∫–∞–∫–æ–≥–æ flood (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ DHT FindProviders)
- ‚úÖ –ù–∏–∫–∞–∫–æ–≥–æ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ NAT (AutoNAT + Hole Punching + Relay)
- ‚úÖ –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ churn (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤)
- ‚úÖ O(log N) —Ä–æ—Å—Ç (Kademlia DHT)
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –±–∞—Ç–∞—Ä–µ–∏ (—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã)
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ —Ñ–æ–Ω–µ Android (foreground service)

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

### 1. –ü–æ–∏—Å–∫ –ø–æ —Ç–æ–∫–µ–Ω–∞–º –≤ —Å–µ—Ç–∏ ‚úÖ

**–¢–ó —Ç—Ä–µ–±—É–µ—Ç:**
```
1. –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç
2. —Ç–µ–∫—Å—Ç ‚Üí —Ç–æ–∫–µ–Ω—ã
3. –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞:
   - FindProviders(/token/<hash>)
4. –ø–æ–ª—É—á–∞–µ–º CTID
5. FindProviders(/ctid/<CTID>)
6. –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–∏—Ä–æ–≤
```

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞
- ‚úÖ FindProviders(/token/<hash>) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –û–±—ä—è–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ DHT –ø—Ä–∏ ShareTrack (ProvideToken)
- ‚úÖ FindProviders(/ctid/<CTID>) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- ‚úÖ Eventual consistency –º–æ–¥–µ–ª—å (–∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¢–ó)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é**:
- ‚úÖ –ü—Ä–æ—Ç–æ–∫–æ–ª `/cotune/index/1.0.0` –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤
- ‚úÖ `QueryPeerIndex()` –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ CTID –ø–æ —Ç–æ–∫–µ–Ω—É —É –ø–∏—Ä–∞
- ‚úÖ `HandleIndexQuery()` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–Ω–¥–µ–∫—Å–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `searchNetwork()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è CTID –æ—Ç –ø–∏—Ä–æ–≤

### 2. IPC —á–µ—Ä–µ–∑ protobuf ‚úÖ

**–¢–ó —Ç—Ä–µ–±—É–µ—Ç:**
- IPC —á–µ—Ä–µ–∑ protobuf (Unix socket –∏–ª–∏ localhost TCP)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ Protobuf/gRPC —Å–µ—Ä–≤–µ—Ä (`internal/api/proto/server.go`)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ localhost TCP (`127.0.0.1:7777`)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Unix socket (`unix:///tmp/cotune.sock`)
- ‚úÖ –í—Å–µ –º–µ—Ç–æ–¥—ã API —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ protobuf
- ‚úÖ Go protobuf –∫–æ–¥ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω

## üìä –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|--------------|-------------|
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | ‚úÖ 100% | –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç |
| CTR | ‚úÖ 100% | –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω |
| DHT | ‚úÖ 100% | –¢–æ–ª—å–∫–æ provider records |
| –°—Ç—Ä–∏–º–∏–Ω–≥ | ‚úÖ 100% | Chunk-based, –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–∏—Ä–æ–≤ |
| –†–µ–ø–ª–∏–∫–∞—Ü–∏—è | ‚úÖ 100% | –¢–æ–ª—å–∫–æ –ø–æ –ª–∞–π–∫–∞–º |
| –ü–æ–∏—Å–∫ | ‚úÖ 100% | –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å–æ–≥–ª–∞—Å–Ω–æ –¢–ó |
| Android –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | ‚úÖ 100% | Protobuf/gRPC IPC —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω |
| –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ | ‚úÖ 100% | –í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã |

**–û–±—â–µ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ: ‚úÖ 100%**

## ‚úÖ –í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

1. **IPC —á–µ—Ä–µ–∑ protobuf** ‚úÖ:
   - Protobuf/gRPC —Å–µ—Ä–≤–µ—Ä —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ localhost TCP –∏ Unix socket
   - –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¢–ó –ø–æ–ª–Ω–æ—Å—Ç—å—é

2. **–ü–æ–∏—Å–∫ –ø–æ —Ç–æ–∫–µ–Ω–∞–º** ‚úÖ:
   - FindProviders(/token/<hash>) —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
   - –ü—Ä–æ—Ç–æ–∫–æ–ª `/cotune/index/1.0.0` –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤
   - –ó–∞–ø—Ä–æ—Å CTID —É –ø–∏—Ä–æ–≤ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
   - Eventual consistency –º–æ–¥–µ–ª—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¢–ó

3. **–†–µ–ø–ª–∏–∫–∞—Ü–∏—è –ø—Ä–∏ –ª–∞–π–∫–µ** ‚úÖ:
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Ç—Ä–µ–∫–æ–≤ –ø—Ä–∏ –ª–∞–π–∫–µ
   - –ü–æ–ª–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ –¥–µ–π—Å—Ç–≤–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¢–ó –ø–æ–ª–Ω–æ—Å—Ç—å—é

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã. –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.
